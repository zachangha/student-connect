<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>announcementview.js - Documentation</title>

    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css" />
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css" />
    <script src="scripts/nav.js" defer></script>

    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  </head>
  <body>
    <input type="checkbox" id="nav-trigger" class="nav-trigger" />
    <label for="nav-trigger" class="navicon-button x">
      <div class="navicon"></div>
    </label>

    <label for="nav-trigger" class="overlay"></label>

    <nav>
      <input type="text" id="nav-search" placeholder="Search" />

      <h2><a href="index.html">Home</a></h2>
    </nav>

    <div id="main">
      <h1 class="page-title">announcementview.js</h1>

      <section>
        <article>
          <pre
            class="prettyprint source linenums"
          ><code>import React, { useEffect, useState } from "react";
import Button from "@mui/material/Button";
import "./styles/classes.css";
import { useNavigate } from "react-router-dom";

const Courses = () => {
  const user = JSON.parse(localStorage.getItem("user"));
  const [course, setCourse] = useState([]);
  const [announcements, setAnnouncement] = useState([]);

  const navigate = useNavigate();

  const currentUrl = window.location.href;
  const courseID = currentUrl.match(/\/course\/([^\/]+)\//)[1];
  const objectID = currentUrl.match(/\/([^\/]+)$/)[1];

  const targetAnnouncement = announcements.find((obj) => obj._id === objectID);

  // FOR LATER PLEASE DONT DELETE
  //   const formatDate = async () => {
  //     console.log(targetAnnouncement.datePosted);
  //     const month = targetAnnouncement.datePosted.toLocaleString("default", {
  //       month: "long",
  //     });
  //     const day = targetAnnouncement.datePosted.getUTCDate();
  //     const year = targetAnnouncement.datePosted.getUTCFullYear();
  //     const formattedDate = `${month} ${day}, ${year}`;
  //     console.log(formattedDate);
  //   };

  /**
   * Redirect to the create announcement page
   */
  const redirectToAddAnnouncement = () => {
    navigate(`/course/${courseID}/announcement`);
  };

  /**
   * use course.id to get a courses's information to display and post information for the user.
   */
  const getCourse = async () => {
    try {
      const response = await fetch(`/api/course/get/${courseID}`, {
        method: "GET",
        headers: {
          "Content-Type": "application/json",
        },
      });
      if (response.ok) {
        const retrivedCourse = await response.json();
        setCourse(retrivedCourse);
      } else {
        const result = await response.json();
        throw new Error(result.message || "Could not load course");
      }
    } catch (error) {
      alert(error.message);
    }
  };

  /**
   * Get a course's array of announcements by it's courseID.
   */
  const getAnnouncements = async () => {
    try {
      const response = await fetch(`/api/course/announcement/${courseID}`, {
        method: "GET",
        headers: {
          "Content-Type": "application/json",
        },
      });
      if (response.ok) {
        const retrivedAnnouncements = await response.json();
        setAnnouncement(retrivedAnnouncements);
      } else {
        const result = await response.json();
        throw new Error(result.message || "Could not load course");
      }
    } catch (error) {
      alert(error.message);
    }
  };

  //MODIFY THIS!! should allow user to post QA
  const postQA = () => {};

  useEffect(() => {
    getCourse();
    getAnnouncements();
  }, []);

  //student view of the class, cannot post announcements
  if (user.role === "student") {
    return (
      &lt;body className="bigouterbox">
        &lt;div className="QAbox">
          {course.map((course) => (
            &lt;h1>Class: {course.className}&lt;/h1>
          ))}

          &lt;div>Role: {user.role}&lt;/div>
          &lt;br>&lt;/br>
          &lt;br>&lt;/br>
          &lt;h2 className="border">Announcements:&lt;/h2>

          &lt;div className="border">
            {announcements.slice(0, 5).map((announcement) => (
              &lt;li>
                &lt;a href={`/course/${courseID}/view/${announcement._id}`}>
                  {announcement.title}
                &lt;/a>
              &lt;/li>
            ))}
          &lt;/div>
          &lt;br>&lt;/br>
          &lt;br>&lt;/br>
          &lt;h2 className="border">
            Q&amp;A
            &lt;Button
              variant="contained"
              color="primary"
              onClick={postQA}
              className="postButton"
            >
              +
            &lt;/Button>
          &lt;/h2>
          &lt;div className="border">put Q&amp;A here&lt;/div>
        &lt;/div>

        &lt;div className="postingInfo">
          &lt;br>&lt;/br>
          &lt;br>&lt;/br>
          {targetAnnouncement ? (
            &lt;div>
              &lt;h1>{targetAnnouncement.title}&lt;/h1>
              &lt;p>{targetAnnouncement.message}&lt;/p>
              &lt;p>{}&lt;/p>
            &lt;/div>
          ) : (
            &lt;p>Object not found.&lt;/p>
          )}
        &lt;/div>
      &lt;/body>
    );
  }

  //Teacher view of the class, can post announcements &amp; QA
  else if (user.role === "teacher") {
    return (
      &lt;body className="bigouterbox">
        &lt;div className="QAbox">
          {course.map((course) => (
            &lt;h1>Class: {course.className}&lt;/h1>
          ))}

          &lt;div>Role: {user.role}&lt;/div>
          &lt;br>&lt;/br>
          &lt;br>&lt;/br>
          &lt;h2 className="border">
            Announcements:
            &lt;Button
              variant="contained"
              color="primary"
              onClick={redirectToAddAnnouncement}
              className="postButton"
            >
              +
            &lt;/Button>
          &lt;/h2>

          &lt;div className="border">
            {announcements.slice(0, 5).map((announcement) => (
              &lt;li>
                &lt;a href={`/course/${courseID}/view/${announcement._id}`}>
                  {announcement.title}
                &lt;/a>
              &lt;/li>
            ))}
          &lt;/div>
          &lt;br>&lt;/br>
          &lt;br>&lt;/br>
          &lt;h2 className="border">
            Q&amp;A
            &lt;Button
              variant="contained"
              color="primary"
              onClick={postQA}
              className="postButton"
            >
              +
            &lt;/Button>
          &lt;/h2>
          &lt;div className="border">put Q&amp;A here&lt;/div>
        &lt;/div>

        &lt;div className="postingInfo">
          &lt;br>&lt;/br>
          &lt;br>&lt;/br>
          {targetAnnouncement ? (
            &lt;div>
              &lt;h1>{targetAnnouncement.title}&lt;/h1>
              &lt;p>{targetAnnouncement.message}&lt;/p>
              &lt;p>{}&lt;/p>
            &lt;/div>
          ) : (
            &lt;p>Object not found.&lt;/p>
          )}
        &lt;/div>
      &lt;/body>
    );

    //Catch all scenario
  } else {
    return (
      &lt;div className="classes-container">
        {course.map((course) => (
          &lt;h1>{course.className}&lt;/h1>
        ))}
      &lt;/div>
    );
  }
};

export default Courses;
</code></pre>
        </article>
      </section>
    </div>

    <br class="clear" />

    <footer>
      Documentation generated by
      <a href="https://github.com/jsdoc3/jsdoc">JSDoc 4.0.3</a> on Mon May 06
      2024 15:39:57 GMT-0700 (Pacific Daylight Time) using the
      <a href="https://github.com/clenemt/docdash">docdash</a> theme.
    </footer>

    <script>
      prettyPrint();
    </script>
    <script src="scripts/polyfill.js"></script>
    <script src="scripts/linenumber.js"></script>

    <script src="scripts/search.js" defer></script>
  </body>
</html>
